aov3 <- with(study2[study2$train==1,], aov(quality ~ train * age * educ))
study2$educ <- as.factor(study2$educ)
aov3 <- with(study2[study2$train==1,], aov(quality ~ train * age * educ))
aov3 <- with(study2[study2$train==1,], aov(quality ~ educ))
summary(aov3)
contrasts(study2$educ) <- cbind(c(0,1,0),c(0,0,1))
aov3 <- with(study2[study2$train==1,], aov(quality ~ educ))
summary(aov3)
aov3 <- with(study2[study2$train==1,], lm(quality ~ educ))
summary(aov3)
lm3 <- with(study2[study2$train==1,], lm(quality ~ educ))
summary(lm3)
contrasts(study2$age) <- cbind(c(0,1,0),c(0,0,1))
lm4 <- with(study2, lm(quality ~ age))
summary(lm4)
aov3_1 <- with(study2[study2$train==0,], aov(quality ~ educ))
summary(aov3_1)
aov3 <- with(study2[study2$train==1,], aov(quality ~ educ))
summary(aov3)
summary(lm3)
summary(lm4)
summary(aov2)
contrasts(study2$age) <- cbind(c(0,1,0),c(0,0,1))
contrasts(study2$train) <- cbind(c(0,1,0),c(0,0,1))
lm0 <- with(study2, lm(quality ~ train))
summary(lm0)
lm1 <- with(study1, lm(quality ~ train * age * educ))
lm1 <- with(study2, lm(quality ~ train * age * educ))
summary(lm1)
lm1 <- with(study2, lm(quality ~ train * age))
summary(lm1)
with(study2, interaction.plot(age, educ, incom))
summary(study2$educ)
rs1 = chisq.test(educdist, p=c(1, 1, 1), rescale.p = T, simulate.p.value = F)
educdist <- summary(study2$educ)
rs1 = chisq.test(educdist, p=c(1, 1, 1), rescale.p = T, simulate.p.value = F)
print(rs1)
prs1 = rs1$p.value
p9 <- ggplot(study2, aes(age, fill=educ))
p9 + geom_bar() # 'thirteenth plot'
summary(study2$age*study2$educ)
summary(study2$age, study2$educ)
summary(study2$age)
with(study2[study2$age==1,] educ)
with(study2[study2$age==1,], educ)
with(study2[study2$age==1,], summary(educ))
with(study2[study2$age==2,], summary(educ))
with(study2[study2$age==3,], summary(educ))
matr1 = matrix(cbind(age1, age2, age3), byrow=T, ncol=3)
age1 <- with(study2[study2$age==1,], summary(educ)) # counts for each education level within youngest age group
age2 <- with(study2[study2$age==2,], summary(educ))
age3 <- with(study2[study2$age==3,], summary(educ))
matr1 = matrix(cbind(age1, age2, age3), byrow=T, ncol=3)
print(matr1)
chimatr = chisq.test(matrix)
chimatr = chisq.test(matr1)
print(chimatr)
with(study2[study2$educ==1,], summary(age))
educ1dist = with(study2[study2$educ==1,], summary(age))
rs1 = chisq.test(educ1dist, p=c(1, 1, 1), rescale.p = T, simulate.p.value = F)
print(rs1)
educ2dist = with(study2[study2$educ==2,], summary(age))
rs2 = chisq.test(educ2dist, p=c(1, 1, 1), rescale.p = T, simulate.p.value = F)
print(rs2)
educ3dist = with(study2[study2$educ==3,], summary(age))
rs3 = chisq.test(educ3dist, p=c(1, 1, 1), rescale.p = T, simulate.p.value = F)
print(rs3)
p10 <- ggplot(study2, aes(x = quality, y = incom, group = age, colour = age))
p10 + geom_point() + facet_wrap(~educ, scales = "fixed") + geom_smooth(method = "lm", se = FALSE)
p11 <- ggplot(study2, aes(x = quality, y = incom, group = age, colour = age))
p11 + geom_point() + geom_smooth(method = "lm", se = FALSE)
p12 <- ggplot(study2, aes(x = quality, y = incom, group = educ, colour = educ))
p12 + geom_point() + geom_smooth(method = "lm", se = FALSE)
lm1 <- lm(incom ~ quality * age, data = study2)
summary(lm1)
lm1_1 <- lm(incom ~ scale(quality) * age, data = study2)
summary(lm1_1)
with(study2, plot(incom ~ quality * age))
with(study2, interaction.plot(incom ~ quality * age))
with(study2, interaction.plot(quality, age, incom))
lm1_2 <- lm(incom ~ scale(quality) * age, data = study2)
summary(lm1_2)
contrasts(study$age) = cbind(lin = c(-1, 0, 1), quad = c(-1, 2, -1))
lm1_2 <- lm(incom ~ scale(quality) * age, data = study2)
summary(lm1_2)
contrasts(study2$age) = cbind(lin = c(-1, 0, 1), quad = c(-1, 2, -1))
lm1_2 <- lm(incom ~ scale(quality) * age, data = study2)
summary(lm1_2)
lm2 <- lm(incom ~ scale(quality) * scale(quality)^2, data = study2)
summary(lm2)
lm1_1 <- lm(incom ~ scale(quality, scale = F) * age, data = study2)
summary(lm1_1)
contrasts(study2$age) = cbind(c(0, 1, 0), c(0, 0, 1))
lm1_1 <- lm(incom ~ scale(quality, scale = F) * age, data = study2)
summary(lm1_1)
contrasts(study2$age) = cbind(lin = c(-1, 0, 1), quad = c(-1, 2, -1))
lm1_2 <- lm(incom ~ scale(quality, scale = F) * age, data = study2)
summary(lm1_2)
lm2 <- lm(incom ~ scale(quality, scale = F) * I(scale(quality))^2, data = study2)
summary(lm2)
lm2 <- lm(incom ~ scale(quality, scale = F) * I(scale(quality)^2), data = study2)
summary(lm2)
p13 <- ggplot(study2, aes(x=quality, y=incom))
p13 + geom_point() + geom_smooth(method = "lm", se = FALSE)
lm0 <- lm(incom ~ quality, data = study2)
summary(lm0)
lm1 <- lm(incom ~ quality * age, data = study2)
summary(lm1)
contrasts(study2$age) = cbind(c(1, 0, 0), c(0, 0, 1))
lm1 <- lm(incom ~ quality * age, data = study2)
summary(lm1)
lm1_1 <- lm(incom ~ scale(quality, scale = F) * age, data = study2)
summary(lm1_1)
lm1_3 <- lm(incom ~ I(scale(quality, scale = F) - sd(quality)) * age, data = study2)
summary(lm1_3)
lm1_3 <- lm(incom ~ I(scale(quality, scale = F) + sd(quality)) * age, data = study2)
summary(lm1_3)
lm1_3 <- lm(incom ~ I(scale(quality, scale = F) - 2sd(quality)) * age, data = study2)
summary(lm1_3)
lm1_3 <- lm(incom ~ I(scale(quality, scale = F) - 2sd(quality)) * age, data = study2)
lm1_3 <- lm(incom ~ I(scale(quality, scale = F) - 2*sd(quality)) * age, data = study2)
summary(lm1_3)
lm1_3 <- lm(incom ~ I(scale(quality, scale = F) - sd(quality)) * age, data = study2)
summary(lm1_3)
lm1_1 <- lm(incom ~ scale(quality, scale = F) * age, data = study2)
summary(lm1_1)
lm1_1 <- lm(incom ~ scale(quality, scale = F) * age, data = study2)
summary(lm1_1)
lm1_1 <- lm(incom ~ scale(quality, scale = F) * educ, data = study2)
summary(lm1_1)
lm3 <- lm(incom ~ scale(quality, scale = F) * educ, data = study2)
summary(lm3)
lm4 <- lm(incom ~ scale(quality, scale = F) * educ * age, data = study2)
summary(lm4)
lm1_3 <- lm(incom ~ scale(quality, scale = F) * age, data = study2)
summary(lm1_3)
lm1_3 <- lm(incom ~ scale(quality, scale = F) * I(scale(quality, scale = F)^2) * age, data = study2)
summary(lm1_3)
lm1_2 <- lm(incom ~ scale(quality, scale = F) * age, data = study2)
summary(lm1_2)
lm4 <- lm(incom ~ scale(quality, scale = F) * educ * age, data = study2)
summary(lm4)
lm4 <- lm(incom ~ scale(quality, scale = F) * educ + age, data = study2)
summary(lm4)
summary(lm5)
lm5 <- lm(incom ~ scale(quality, scale = F) * educ * age, data = study2)
summary(lm5)
lm6 <- lm(incom ~ age * educ, data = study2)
summary(lm6)
contrasts(study2$educ) = cbind(c(0, 1, 0), c(0, 0, 1))
contrasts(study2$age) = cbind(c(1, 0, 0), c(0, 0, 1))
lm6 <- lm(incom ~ age * educ, data = study2)
summary(lm6)
contrasts(study2$educ) = cbind(c(1, 0, 0), c(0, 0, 1)) # compare mod educ to low and high educ
contrasts(study2$age) = cbind(c(1, 0, 0), c(0, 0, 1)) # compare mid-age to young and old
lm6 <- lm(incom ~ age * educ, data = study2)
summary(lm6)
lm7 <- lm(incom ~ age * educ, data = study2)
contrasts(study2$educ) = cbind(lin = c(-1, 0, 1), quad = c(-1, 2, -1)) # compare mod educ to low and high educ
contrasts(study2$age) = cbind(lin = c(-1, 0, 1), quad = c(-1, 2, -1)) # compare mid-age to young and old
lm7 <- lm(incom ~ age * educ, data = study2)
summary(lm7)
with(study2, interaction.plot(educ, age, incom))
educ1 <- study2[study2$educ==1,]
lm8 <- lm(incom ~ age, data = educ1)
summary(lm8)
lm9 <- lm(incom ~ age, data = educ2)
summary(lm9)
educ2 <- study2[study2$educ==2,]
educ3 <- study2[study2$educ==3,]
summary(lm9)
lm9 <- lm(incom ~ age, data = educ2)
summary(lm9)
lm10 <- lm(incom ~ age, data = educ3)
summary(lm10)
contrasts(study2$age) = cbind(1vs23 = c(-2, 1, 1), 2vs3 = c(0, 1, -1))
contrasts(study2$age) = cbind(low = c(-2, 1, 1), high = c(0, 1, -1))
lm8 <- lm(incom ~ age, data = educ1)
summary(lm8)
contrasts(educ1$age) = cbind(low = c(-2, 1, 1), high = c(0, 1, -1))
lm8 <- lm(incom ~ age, data = educ1)
summary(lm8)
contrasts(study2$age) = cbind(lin = c(-1, 0, 1), quad = c(-1, 2, -1))
educ1 <- study2[study2$educ==1,]
educ2 <- study2[study2$educ==2,]
educ3 <- study2[study2$educ==3,]
lm8 <- lm(incom ~ age, data = educ1)
summary(lm8)
lm9 <- lm(incom ~ age, data = educ2)
summary(lm9) # marg sig agequad
lm10 <- lm(incom ~ age, data = educ3)
summary(lm10) # sig lin, marg sig agequad
contrasts(study2$educ) = cbind(lin = c(-1, 0, 1), quad = c(-1, 2, -1))
contrasts(study2$age) = cbind(lin = c(-1, 0, 1), quad = c(-1, 2, -1))
library(ggplot2)
study2 <- read.csv("http://www.stanford.edu/class/psych252/data/couples1.csv")
head(study2)
study2$age <- as.factor(study2$age)
study2$educ <- as.factor(study2$educ)
study2$train <- as.factor(study2$train)
study2$counsel <- as.factor(study2$counsel)
study2$counrep <- as.factor(study2$counrep)
summary(study2)
str(study2)
contrasts(study2$educ) = cbind(lin = c(-1, 0, 1), quad = c(-1, 2, -1))
contrasts(study2$age) = cbind(lin = c(-1, 0, 1), quad = c(-1, 2, -1))
lm7 <- lm(incom ~ age * educ, data = study2)
summary(lm7)
lm8 <- lm(incom ~ age, data = educ1)
summary(lm8)
educ1 <- study2[study2$educ==1,]
educ2 <- study2[study2$educ==2,]
educ3 <- study2[study2$educ==3,]
lm8 <- lm(incom ~ age, data = educ1)
summary(lm8)
p6 <- with(study2, interaction.plot(train, educ, quality))
p6_1 <- with(study2, interaction.plot(train, age, quality))
with(study2, interaction.plot(age, educ, incom))
with(study2, interaction.plot(educ, age, incom))
head(educ1)
head(educ2)
summary(educ1)
contrasts(study2$age) = cbind(lin = c(-2, 1, 1), quad = c(0, -1, 1))
lm8 <- lm(incom ~ age, data = educ1)
summary(lm8)
contrasts(study2$age) = cbind(lin = c(-1, 0, 1), quad = c(-1, 2, -1))
lm8 <- lm(incom ~ age, data = educ1)
summary(lm8)
contrasts(educ1$age) = cbind(lin = c(-1, 0, 1), quad = c(-1, 2, -1))
lm8 <- lm(incom ~ age, data = educ1)
summary(lm8)
contrasts(educ1$age) = cbind(lin = c(-2, 1, 1), quad = c(0, -1, 1))
lm8 <- lm(incom ~ age, data = educ1)
summary(lm8)
plot(income ~ age, educ1)
plot(incom ~ age, educ1)
plot(incom ~ age, educ2)
plot(incom ~ age, educ3)
contrasts(educ1$age) = cbind(lin = c(-1, 0, 1), quad = c(1, -2, 1))
lm8 <- lm(incom ~ age, data = educ1)
summary(lm8)
plot(incom ~ age, educ1)
plot(incom ~ age, educ2)
plot(incom ~ age, educ3)
contrasts(educ2$age) = cbind(lin = c(-1, 0, 1), quad = c(1, -2, 1))
lm9 <- lm(incom ~ age, data = educ2)
summary(lm9)
contrasts(educ3$age) = cbind(lin = c(-2, 1, 1), quad = c(0, -1, 1))
lm10_1 <- lm(incom ~ age, data = educ3)
summary(lm10_1)
contrasts(educ3$age) = cbind(lin = c(-1, 0, 1), quad = c(1, -2, 1))
lm10 <- lm(incom ~ age, data = educ3)
summary(lm10)
contrasts(educ3$age) = cbind(lin = c(-2, 1, 1), quad = c(0, -1, 1))
lm10_1 <- lm(incom ~ age, data = educ3)
summary(lm10_1)
contrasts(educ3$age) = cbind(first_vs_secthird = c(-2, 1, 1), sec_vs_third = c(0, -1, 1))
lm10_1 <- lm(incom ~ age, data = educ3)
summary(lm10_1)
contrasts(educ1$age) = cbind(lin = c(-1, 0, 1), quad = c(1, -2, 1))
lm8 <- lm(incom ~ age, data = educ1)
summary(lm8)
lm9 <- lm(incom ~ age, data = educ2)
summary(lm9)
contrasts(educ2$age) = cbind(lin = c(-1, 0, 1), quad = c(1, -2, 1))
lm9 <- lm(incom ~ age, data = educ2)
summary(lm9)
contrasts(educ3$age) = cbind(lin = c(-1, 0, 1), quad = c(1, -2, 1))
lm10 <- lm(incom ~ age, data = educ3)
summary(lm10)
contrasts(educ3$age) = cbind(first_vs_secthird = c(-2, 1, 1), sec_vs_third = c(0, -1, 1))
lm10_1 <- lm(incom ~ age, data = educ3)
summary(lm10_1)
age1 <- study2[study2$age==1,]
age2 <- study2[study2$age==2,]
age3 <- study2[study2$age==3,]
plot(incom ~ educ, age1)
plot(incom ~ educ, age2)
plot(incom ~ educ, age3)
contrasts(age1$educ) = cbind(lin = c(-1, 0, 1), quad = c(1, -2, 1))
lm11 <- lm(incom ~ educ, data = age1)
summary(lm11)
contrasts(age1$educ) = cbind(lin = c(-1, -1, 2), quad = c(1, -1, 0))
lm11 <- lm(incom ~ educ, data = age1)
summary(lm11)
contrasts(age2$educ) = cbind(lin = c(-1, 0, 1), quad = c(1, -2, 1))
lm12 <- lm(incom ~ educ, data = age2)
summary(lm12)
contrasts(age3$educ) = cbind(lin = c(-1, 0, 1), quad = c(1, -2, 1))
lm13 <- lm(incom ~ educ, data = age3)
summary(lm13)
contrasts(age1$educ) = cbind(lin = c(-1, 0, 1), quad = c(1, -2, 1))
lm11 <- lm(incom ~ educ, data = age1)
summary(lm11) # ns
summary(lm12) # sig lin
summary(lm13) # marg sig lin
with(study2, cor.test(quality, incom))
aov_sex <- with(study1, aov(vocabsize ~ time0 * sex))
study1 <- read.csv("http://www.stanford.edu/class/psych252/data/vocab0.csv")
# make sex a factor, rename the levels
study1$sex <- as.factor(study1$sex)
levels(study1$sex) <- c("male", "female")
# make time a factor
study1$time0 <- as.factor(study1$time0)
levels(study1$time0) <- c("18m", "21m", "24m", "30m")
#rename var vocabsize to make it easier to remember for me
study1$vocabsize <- study1$wordsprod
```
Create plots:
```{r 1plot1}
library(ggplot2)
# interaction plot:
with(study1, interaction.plot(time0, sex, vocabsize))
aov_sex <- with(study1, aov(vocabsize ~ time0 * sex))
summary(aov_sex)
p6 <- with(study2, interaction.plot(train, educ, quality))
library(ggplot2)
study2 <- read.csv("http://www.stanford.edu/class/psych252/data/couples1.csv")
head(study2)
study2$age <- as.factor(study2$age)
study2$educ <- as.factor(study2$educ)
study2$train <- as.factor(study2$train)
study2$counsel <- as.factor(study2$counsel)
study2$counrep <- as.factor(study2$counrep)
summary(study2)
str(study2)
p5 <- ggplot(study2, aes(train, quality))
p5 + geom_boxplot(aes(fill = educ))
p6 <- with(study2, interaction.plot(train, educ, quality))
head(study1)
contrasts(study1$time0) = dummy
contrasts(study1$time0) = dummy
1
dummy = cbind(c(0, 1, 0, 0), c(0, 0, 1, 0), c(0, 0, 0, 1))
lm2_1 = lm(vocabsize ~ time0 * sex, data = study1) # interactive
summary(lm2_1)
lm_1 = lm(vocabsize ~ time0 + sex, data = study1) # additive
summary(lm_1)
anova(lm_1, lm2_1)
anova(lm, lm_1)
accel = c(-1, -1, 1, 1) # test whether time1 and 2 are different from time3 and 4
accel12 = c(-1, 1, 0, 0) # test whether time1 and 2 are different from each other
accel34 = c(0, 0, -1, 1) # test whether time3 and 4 are different from each other
lm = lm(vocabsize ~ time0 + sex, data = study1) # additive
summary(lm)
anova(lm, lm_1)
bartlett.test(vocabsize ~ time0, data = study1)
bartlett.test(vocabsize ~ sex, data = study1)
aov_sex0 <- with(study1, oneway.test(vocabsize ~ sex, var.equal = TRUE))
summary(aov_sex)
summary(aov_sex0)
with(study2, interaction.plot(counsel, age, quality))
with(study2, interaction.plot(counsel, educ, quality))
aov2 <- with(study2, aov(quality ~ counsel * age * educ))
summary(aov2)
aov3 <- with(study2, aov(quality ~ educ))
summary(aov3)
bartlett.test(quality ~ counsel * age, data = study2)
bartlett.test(quality ~ train * age * educ, data = study2)
with(study1, coplot(vocabsize ~ time0 | sex))
with(study2, coplot(incom ~ quality | age))
with(study2, coplot(incom ~ quality | educ))
with(study2, interaction.plot(age, educ, incom))
with(study2, interaction.plot(educ, age, incom))
p12 <- ggplot(study2, aes(x = quality, y = incom, group = educ, colour = educ))
p12 + geom_point() + geom_smooth(method = "lm", se = FALSE)
p13 <- ggplot(study2, aes(x=quality, y=incom))
p13 + geom_point() + geom_smooth(method = "lm", se = FALSE)
library(psych)
partial.r(study2, quality, income)
dataC = read.csv("http://www.stanford.edu/class/psych252/_downloads/lifesatis.csv")
head(dataC)
with(study1, interaction.plot(time0, sex, vocabsize))
study2_0 <- read.table("http://www.stanford.edu/class/psych252/data/couples5.txt")
View(study2_0)
View(study2)
summary(d)
d <- read.csv("/Users/ericang/Documents/Erica/Stanford/2013-Q2-Winter/Research/simpimpGIT/Data_analysis/processed_data/simpimp_processed.csv")
head(d)
library(reshape)
order <- read.csv("/Users/ericang/Documents/Erica/Stanford/2013-Q2-Winter/Research/simpimpGIT/Data_analysis/info/simpkid_order.csv")
head(order)
d <- join(d, order) # use join rather than merge because it doesn't sort
order2 <- read.csv("/Users/ericang/Documents/Erica/Stanford/2013-Q2-Winter/Research/simpimpGIT/Data_analysis/info/simpkid-log.csv")
d <- join(d, order2) # use join rather than merge because it doesn't sort
summary(d)
d$x[d$y== "1050" & d$x=="0"] <- NA
d$y[d$y== "1050"] <- NA
head(d)
# make a column that shows whether NA (true) or not (false)
d$count.na <- is.na(d$x)
head(d)
# remove those rows where column 'targetOnset' is NA (i.e., rows that are not showing test trials)
d <- subset(d,targetOnset != "NA")
head(d)
## TRIAL REJECTION: reject trials that have NAs for over 30% of their samples
trial.nas <- ddply(d,c("subid", "stimulus", "count.na"),"nrow")
trial.nas<- reshape(trial.nas, timevar="count.na", idvar=c("subid", "stimulus"), direction="wide")
names(trial.nas) <- c("subid", "stimulus","false","true")
head(trial.nas)
#calculate the proportion of non-NA's over all
trial.nas$prop <-trial.nas$false / (trial.nas$true + trial.nas$false)
summary(trial.nas)
reject.trials <- trial.nas[trial.nas$prop < .5,]
# add a column in data that combines subid and stim (trial)
d$subtrial <- paste(d$subid,"_",d$stimulus,sep="")
# reject trials
reject.trials$subtrial <- paste(reject.trials$subid,"_",reject.trials$stimulus,sep="")
print(reject.trials)
for(i in reject.trials$subtrial) {
d <- d[d$subtrial !=i,]
}
## SUBJECT REJECTION: reject trials that have NAs for over 30% of their trials
subject.nas <- ddply(d,c("subid", "stimulus"),"nrow")
subject.nas2 <- ddply(subject.nas, "subid", "nrow")
print(subject.nas2)
## reject subjects that have less than 70% of the trials remaining (11 out of 16)
reject.subjects <- subject.nas2[subject.nas2$nrow < 8,]
print(reject.subjects)
for(i in reject.subjects$subid) {
d <- d[d$subid !=i,]
}
summary(d)
summary(d$age_group)
d$age_group
str(d$age_group)
print(subject.nas2)
print(subject.nas)
subj <- ddply(d, c("subid", "age_group"), "nrow")
print(subj)
subj2 <- ddply(subj, "age_group", "nrow")
subj2
rm(list = ls())
setwd("/Users/ericang/Documents/Erica/Stanford/2013-Q2-Winter/Research/simpimpGIT/Data_analysis/")
source("R_scripts/useful.R")
source("R_scripts/et_helper.R")
raw.data.path <- "raw_data/"
info.path <- "info/"
processed.data.path <- "processed_data/"
d <- read.csv("/Users/ericang/Documents/Erica/Stanford/2013-Q2-Winter/Research/simpimpGIT/Data_analysis/processed_data/simpimp_processed.csv")
head(d)
library(reshape)
order <- read.csv("/Users/ericang/Documents/Erica/Stanford/2013-Q2-Winter/Research/simpimpGIT/Data_analysis/info/simpkid_order.csv")
head(order)
nrow(d) # first check number of rows
plot(d$stimulus) # now check the stimulus ordering
order2 <- read.csv("/Users/ericang/Documents/Erica/Stanford/2013-Q2-Winter/Research/simpimpGIT/Data_analysis/info/simpkid-log.csv")
head(order2)
# now join in the orders
d <- join(d, order2) # use join rather than merge because it doesn't sort
plot(d$stimulus) # check that nothing got messed up
nrow(d) # check the number of rows again to see it remained the same
head(d)
summary(d)
d$x[d$y== "1050" & d$x=="0"] <- NA
d$y[d$y== "1050"] <- NA
# make a column that shows whether NA (true) or not (false)
d$count.na <- is.na(d$x)
# remove those rows where column 'targetOnset' is NA (i.e., rows that are not showing test trials)
d <- subset(d,targetOnset != "NA")
## TRIAL REJECTION: reject trials that have NAs for over 30% of their samples
trial.nas <- ddply(d,c("subid", "stimulus", "count.na"),"nrow")
trial.nas<- reshape(trial.nas, timevar="count.na", idvar=c("subid", "stimulus"), direction="wide")
names(trial.nas) <- c("subid", "stimulus","false","true")
head(trial.nas)
#calculate the proportion of non-NA's over all
trial.nas$prop <-trial.nas$false / (trial.nas$true + trial.nas$false)
summary(trial.nas)
reject.trials <- trial.nas[trial.nas$prop < .5,]
# add a column in data that combines subid and stim (trial)
d$subtrial <- paste(d$subid,"_",d$stimulus,sep="")
# reject trials
reject.trials$subtrial <- paste(reject.trials$subid,"_",reject.trials$stimulus,sep="")
print(reject.trials)
for(i in reject.trials$subtrial) {
d <- d[d$subtrial !=i,]
}
## SUBJECT REJECTION: reject trials that have NAs for over 30% of their trials
subject.nas <- ddply(d,c("subid", "stimulus"),"nrow")
subject.nas2 <- ddply(subject.nas, "subid", "nrow")
print(subject.nas2)
## reject subjects that have less than 70% of the trials remaining (11 out of 16)
reject.subjects <- subject.nas2[subject.nas2$nrow < 8,]
print(reject.subjects)
for(i in reject.subjects$subid) {
d <- d[d$subid !=i,]
}
subj <- ddply(d, c("subid", "age_group"), "nrow")
subj2 <- ddply(subj, "age_group", "nrow")
subj2
rois <- list()
rois[[1]] <- c(0,250,840,650) # left
rois[[2]] <- c(840,250,840,650) # right
names(rois) <- c("L","R")
roi.image(rois)
d$roi <- roi.check(d,rois)
# see how the distribution of ROIs looks
qplot(roi,data=d)
d$correct <- d$roi == d$targetPos
d$target <- ifelse(d$roi == d$targetPos, "1", "0")
d$dist <- ifelse(d$roi == d$distPos, "1", "0")
d <- rezero.trials(d) # specified in et_helper.R
subsample.hz <- 5 # 10 hz is decent, eventually we should set to 30 or 60 hz
d$t.crit.binned <- round(d$t.crit*subsample.hz)/subsample.hz # subsample step
order2 <- read.csv("/Users/ericang/Documents/Erica/Stanford/2013-Q2-Winter/Research/simpimpGIT/Data_analysis/info/simpkid-log.csv")
head(order2)
# now join in the orders
d <- join(d, order2) # use join rather than merge because it doesn't sort
plot(d$stimulus) # check that nothing got messed up
nrow(d) # check the number of rows again to see it remained the same
head(d)
summary(d)
